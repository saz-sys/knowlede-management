# ユーザーガイド

動画サムネイル抽出アプリケーションの詳細な操作説明・活用方法ガイド。

## 📋 目次

- [アプリケーション概要](#アプリケーション概要)
- [初回起動](#初回起動)
- [基本操作](#基本操作)
- [詳細設定](#詳細設定)
- [活用例](#活用例)
- [トラブルシューティング](#トラブルシューティング)
- [FAQ](#faq)

## 🎯 アプリケーション概要

### できること

このアプリケーションは、MP4動画ファイルから以下の特徴を持つサムネイル画像を自動生成します：

- **AI顔検出**: 人物の顔を自動検出して最適なフレームを選択
- **多様性確保**: 似た場面を避けて、バラエティに富んだサムネイルを生成
- **高品質出力**: 指定したサイズ・解像度での画像出力
- **自動処理**: ユーザーの手間を最小限に抑えた自動化

### 活用場面

- **YouTube動画**: 魅力的なサムネイル作成
- **動画編集**: 編集素材の事前確認
- **プレゼンテーション**: 動画内容のプレビュー作成
- **アーカイブ**: 大量動画の管理・整理

## 🚀 初回起動

### 1. アプリケーション起動

**実行ファイル版の場合:**
```
VideoThumbnailExtractor.exe をダブルクリック（Windows）
VideoThumbnailExtractor.app をダブルクリック（macOS）
./VideoThumbnailExtractor を実行（Linux）
```

**Python版の場合:**
```bash
python run_app.py
```

### 2. 初回設定

初回起動時、アプリケーションは以下を自動実行します：

- 設定ファイル作成（`~/.config/video_thumbnail_extractor/`）
- ログディレクトリ作成
- デフォルト設定の適用

**設定ファイル場所:**
- **Windows**: `%APPDATA%\video_thumbnail_extractor\`
- **macOS**: `~/.config/video_thumbnail_extractor/`
- **Linux**: `~/.config/video_thumbnail_extractor/`

## 🎮 基本操作

### ステップ1: 動画ファイル選択

1. **「動画ファイルを選択」ボタンをクリック**
2. **ファイル選択ダイアログが表示される**
   - 対応形式: MP4ファイル（.mp4）
   - 推奨サイズ: 100MB以下
   - 推奨時間: 30分以下

3. **動画ファイルを選択して「開く」**

```
📁 対応ファイル例:
- sample_video.mp4 ✅
- movie.avi ❌（未対応）
- clip.mov ❌（未対応）
```

### ステップ2: 基本設定

動画選択後、右側の設定パネルで以下を調整：

**サムネイル枚数:**
- 範囲: 1-20枚
- 推奨: 5-10枚
- 用途別推奨値:
  - YouTube: 5-8枚
  - プレゼン: 3-5枚
  - アーカイブ: 10-15枚

**出力サイズ:**
- 最小: 240×240px
- 最大: 4096×4096px
- プリセット:
  - YouTube標準: 1280×720px
  - YouTube高画質: 1920×1080px
  - Instagram: 1080×1080px
  - カスタム: 任意サイズ

### ステップ3: サムネイル生成

1. **「サムネイル抽出開始」ボタンをクリック**

2. **処理進捗を確認**
   ```
   ▓▓▓▓▓▓▓▓░░ 80% 
   顔検出中... (15/20フレーム)
   ```

3. **処理完了を待つ**
   - 短い動画（1-2分）: 10-30秒
   - 中程度（5-10分）: 1-3分
   - 長い動画（30分+）: 5-10分

### ステップ4: 結果確認・保存

1. **生成されたサムネイルを確認**
   ```
   [🖼️ 1] [🖼️ 2] [🖼️ 3] [🖼️ 4] [🖼️ 5]
   ```

2. **保存したいサムネイルを選択**
   - クリックで選択/解除
   - 複数選択可能
   - Ctrl+クリックで追加選択

3. **「選択したサムネイルを保存」をクリック**

4. **保存場所を指定**
   - デフォルト: 元動画と同じフォルダ
   - ファイル名: `元ファイル名_thumbnail_01.png`

## ⚙️ 詳細設定

### 設定ダイアログ

**アクセス方法:**
- メニュー → 設定
- Ctrl+,（ショートカット）

### 一般設定

**出力設定:**
```
┌─────────────────────────────────────┐
│ 📐 出力サイズ                        │
├─────────────────────────────────────┤
│ □ プリセット使用                     │
│   ○ YouTube標準 (1280×720)          │
│   ○ YouTube高画質 (1920×1080)       │
│   ○ Instagram (1080×1080)           │
│   ○ カスタム                        │
│                                     │
│ 📊 幅: [1920] px                    │
│ 📊 高さ: [1080] px                  │
│                                     │
│ 🖼️ 形式: PNG ▼                     │
│ 🎨 品質: 高画質 ▼                   │
└─────────────────────────────────────┘
```

**処理設定:**
```
┌─────────────────────────────────────┐
│ 🔧 処理オプション                    │
├─────────────────────────────────────┤
│ 🎯 サムネイル枚数: [5] 枚            │
│ 📏 最小顔サイズ: [0.01] (比率)       │
│ 🎲 信頼度閾値: [0.5] (0.0-1.0)      │
│                                     │
│ ☑️ 顔検出を優先                     │
│ ☑️ 多様性を重視                     │
│ ☐ 高速処理モード                   │
└─────────────────────────────────────┘
```

### 高度な設定

**メモリ・パフォーマンス:**
```
最大メモリ使用量: [2048] MB
並列処理スレッド数: [4] 個
フレームバッファサイズ: [100] フレーム
処理タイムアウト: [300] 秒
```

**顔検出詳細:**
```
最小検出信頼度: [0.3] - より多くの顔を検出
最大検出信頼度: [0.9] - 確実な顔のみ検出
顔の最小サイズ: [0.01] - 画像の1%以上
顔の最大サイズ: [0.8] - 画像の80%以下
```

## 🎨 活用例

### YouTube動画サムネイル作成

**目的**: クリック率向上のためのサムネイル

**設定:**
- 枚数: 8-10枚
- サイズ: 1920×1080px
- 顔検出優先: ON
- 高画質モード: ON

**手順:**
1. 完成した動画をアップロード
2. 生成されたサムネイルから最も魅力的なものを選択
3. 必要に応じて画像編集ソフトで文字入れ

### プレゼンテーション用プレビュー

**目的**: 動画内容の概要を聴衆に提示

**設定:**
- 枚数: 4-6枚
- サイズ: 1280×720px
- 多様性重視: ON
- 顔検出: OFF（内容重視）

**手順:**
1. プレゼンで使用する動画を処理
2. 生成されたサムネイルをスライドに配置
3. 各サムネイルに説明文を追加

### 大量動画の管理・アーカイブ

**目的**: 動画ライブラリの視覚的整理

**設定:**
- 枚数: 3枚
- サイズ: 480×270px
- 高速処理: ON
- 低画質でも可

**手順:**
1. フォルダ内の全動画を一括処理
2. 生成されたサムネイルをファイル名で整理
3. 動画管理ソフトやデータベースに登録

## 🔧 トラブルシューティング

### 一般的な問題

#### 1. アプリケーションが起動しない

**症状**: ダブルクリックしても何も起こらない

**原因と解決方法:**

**Windows:**
```
原因: Visual C++ Redistributableが未インストール
解決: Microsoft公式サイトからダウンロード・インストール

原因: ウイルス対策ソフトによるブロック
解決: 除外設定に追加または一時的に無効化
```

**macOS:**
```
原因: Gatekeeperによるブロック
解決: システム環境設定 → セキュリティ → 「このまま開く」

原因: 実行権限なし
解決: ターミナルで chmod +x VideoThumbnailExtractor
```

#### 2. 動画ファイルが読み込めない

**症状**: 「サポートされていない形式」エラー

**対象ファイル確認:**
```bash
# ファイル情報確認
ffprobe sample.mp4

# 期待される出力例:
# Input #0, mov,mp4,m4a,3gp,3g2, from 'sample.mp4':
# Duration: 00:05:30.12, start: 0.000000, bitrate: 2500 kb/s
# Stream #0:0: Video: h264, yuv420p, 1920x1080, 25 fps
```

**解決方法:**
```
1. MP4形式に変換
   - H.264コーデック推奨
   - AAC音声コーデック推奨

2. 変換ツール例:
   - HandBrake (無料)
   - FFmpeg (コマンドライン)
   - VLC Media Player

3. 変換コマンド例:
   ffmpeg -i input.avi -codec:v libx264 -codec:a aac output.mp4
```

#### 3. 顔が検出されない

**症状**: 「顔が検出されませんでした」メッセージ

**確認ポイント:**
```
1. 動画に人物が映っているか
2. 顔がはっきり見えるか（横顔・後ろ姿は検出困難）
3. 解像度が低すぎないか（240p以上推奨）
4. 明るさが適切か（暗すぎる動画は検出困難）
```

**設定調整:**
```
信頼度閾値を下げる: 0.5 → 0.3
最小顔サイズを下げる: 0.01 → 0.005
処理フレーム数を増やす: 20 → 50
```

#### 4. 処理が遅い・止まる

**症状**: 進捗が止まる、異常に時間がかかる

**対処方法:**

**メモリ不足の場合:**
```
1. 他のアプリケーションを終了
2. 最大メモリ使用量を下げる: 2048MB → 1024MB
3. フレームバッファを下げる: 100 → 50
```

**CPU負荷の場合:**
```
1. 並列処理スレッド数を下げる: 4 → 2
2. 高速処理モードを有効化
3. 出力サイズを下げる: 1920×1080 → 1280×720
```

**動画サイズの場合:**
```
1. 動画ファイルサイズを確認
2. 長時間動画は分割して処理
3. 解像度を下げて再エンコード
```

#### 5. 保存エラー

**症状**: 「保存に失敗しました」エラー

**確認事項:**
```
1. 保存先フォルダの書き込み権限
2. ディスク容量の確認
3. ファイル名の文字数・特殊文字
4. 同名ファイルの存在（上書き確認）
```

### ログファイル確認

**ログ場所:**
```
Windows: %APPDATA%\video_thumbnail_extractor\logs\
macOS: ~/.config/video_thumbnail_extractor/logs/
Linux: ~/.config/video_thumbnail_extractor/logs/
```

**ログファイル例:**
```
app.log - 一般的なアプリケーションログ
error.log - エラー専用ログ
performance.log - パフォーマンス情報
```

## ❓ FAQ

### Q1: どんな動画形式に対応していますか？

**A:** 現在はMP4形式のみ対応しています。他の形式（AVI、MOV、WMV等）は事前にMP4に変換してください。

### Q2: 生成できるサムネイルの上限はありますか？

**A:** 技術的には20枚まで設定可能ですが、処理時間とメモリ使用量を考慮して5-10枚を推奨しています。

### Q3: 商用利用は可能ですか？

**A:** アプリケーション自体は商用利用可能ですが、使用するライブラリ（OpenCV、MediaPipe）のライセンスをご確認ください。

### Q4: 動画の音声は処理されますか？

**A:** いいえ。このアプリケーションは映像（画像フレーム）のみを処理し、音声は使用しません。

### Q5: オフラインで使用できますか？

**A:** はい。すべての処理はローカルで実行され、インターネット接続は不要です。

### Q6: どのくらいのメモリが必要ですか？

**A:** 通常は2-4GBのRAMを推奨しています。長時間・高解像度動画の場合はより多くのメモリが必要になることがあります。

### Q7: バッチ処理（複数動画の一括処理）はできますか？

**A:** 現在のバージョンでは1つずつの処理になります。将来のバージョンでバッチ処理機能を検討しています。

### Q8: 生成されたサムネイルの品質を向上させるには？

**A:** 以下の設定を試してください：
- 出力サイズを上げる
- 信頼度閾値を上げる（0.7-0.8）
- 元動画の解像度・品質を確認
- 照明条件の良い動画を使用

### Q9: 処理を途中でキャンセルできますか？

**A:** はい。処理中に「キャンセル」ボタンをクリックすることで中断できます。

### Q10: 設定を初期状態に戻すには？

**A:** メニューの「編集」→「設定をリセット」を選択するか、設定フォルダを削除して再起動してください。

---

**サポート情報:**
- 問題が解決しない場合は [Issues](../../issues) にご報告ください
- ログファイルとエラーメッセージを添付していただくと解決が早くなります

**最終更新**: 2025年9月5日  
**対応バージョン**: 1.0.0
